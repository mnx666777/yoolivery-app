import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('ðŸŒ± Seeding database...');

  // Create categories
  const categories = await Promise.all([
    prisma.category.upsert({
      where: { slug: 'beer' },
      update: {},
      create: { name: 'Beer', slug: 'beer' }
    }),
    prisma.category.upsert({
      where: { slug: 'wine' },
      update: {},
      create: { name: 'Wine', slug: 'wine' }
    }),
    prisma.category.upsert({
      where: { slug: 'whisky' },
      update: {},
      create: { name: 'Whisky', slug: 'whisky' }
    }),
    prisma.category.upsert({
      where: { slug: 'rum' },
      update: {},
      create: { name: 'Rum', slug: 'rum' }
    }),
    prisma.category.upsert({
      where: { slug: 'vodka' },
      update: {},
      create: { name: 'Vodka', slug: 'vodka' }
    }),
    prisma.category.upsert({
      where: { slug: 'brandy' },
      update: {},
      create: { name: 'Brandy', slug: 'brandy' }
    })
  ]);

  console.log('âœ… Categories created');

  // Create products
  const products = [
    {
      name: 'Kingfisher Strong 650ml',
      brand: 'Kingfisher',
      description: 'Crisp Indian lager with a strong profile. Great with spicy snacks.',
      price: 19000, // â‚¹190 in paise
      image: 'https://images.unsplash.com/photo-1608270586620-248524c67de9?w=400',
      volumeMl: 650,
      abv: 5.0,
      origin: 'India',
      rating: 4.2,
      stock: 50,
      categorySlug: 'beer'
    },
    {
      name: "McDowell's No.1 750ml",
      brand: "McDowell's",
      description: 'Smooth and balanced Indian whisky with hints of caramel and oak.',
      price: 68000, // â‚¹680 in paise
      image: 'https://images.unsplash.com/photo-1551538827-9c037cb4f32a?w=400',
      volumeMl: 750,
      abv: 42.8,
      origin: 'India',
      rating: 4.0,
      stock: 30,
      categorySlug: 'whisky'
    },
    {
      name: 'Old Monk 750ml',
      brand: 'Old Monk',
      description: 'Iconic dark rum with rich vanilla notes. A North-East favorite.',
      price: 56000, // â‚¹560 in paise
      image: 'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400',
      volumeMl: 750,
      abv: 42.8,
      origin: 'India',
      rating: 4.5,
      stock: 25,
      categorySlug: 'rum'
    },
    {
      name: 'Imphal Dry Lager 500ml',
      brand: 'Imphal Breweries',
      description: 'Clean, refreshing lager inspired by the valley climate of Manipur.',
      price: 18000, // â‚¹180 in paise
      image: 'https://images.unsplash.com/photo-1608270586620-248524c67de9?w=400',
      volumeMl: 500,
      abv: 4.5,
      origin: 'Manipur',
      rating: 4.1,
      stock: 40,
      categorySlug: 'beer'
    },
    {
      name: 'Hills Brandy 750ml',
      brand: 'Hills Distillers',
      description: 'Warm brandy with fruity aromas, popular in the hills during winters.',
      price: 64000, // â‚¹640 in paise
      image: 'https://images.unsplash.com/photo-1551538827-9c037cb4f32a?w=400',
      volumeMl: 750,
      abv: 40.0,
      origin: 'North-East India',
      rating: 4.0,
      stock: 20,
      categorySlug: 'brandy'
    },
    {
      name: 'Smirnoff Red 750ml',
      brand: 'Smirnoff',
      description: 'Premium vodka with smooth taste and clean finish.',
      price: 85000, // â‚¹850 in paise
      image: 'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400',
      volumeMl: 750,
      abv: 40.0,
      origin: 'Russia',
      rating: 4.3,
      stock: 15,
      categorySlug: 'vodka'
    },
    {
      name: 'Sula Red Wine 750ml',
      brand: 'Sula',
      description: 'Rich and fruity red wine with notes of berries and spice.',
      price: 120000, // â‚¹1200 in paise
      image: 'https://images.unsplash.com/photo-1506377247377-2a5b3b417ebb?w=400',
      volumeMl: 750,
      abv: 13.5,
      origin: 'India',
      rating: 4.4,
      stock: 25,
      categorySlug: 'wine'
    }
  ];

  for (const productData of products) {
    const category = categories.find(c => c.slug === productData.categorySlug);
    if (category) {
      await prisma.product.upsert({
        where: { name: productData.name },
        update: {},
        create: {
          name: productData.name,
          brand: productData.brand,
          description: productData.description,
          price: productData.price,
          image: productData.image,
          volumeMl: productData.volumeMl,
          abv: productData.abv,
          origin: productData.origin,
          rating: productData.rating,
          stock: productData.stock,
          categoryId: category.id
        }
      });
    }
  }

  console.log('âœ… Products created');

  // Create a demo user
  const demoUser = await prisma.user.upsert({
    where: { email: 'demo@yoolivery.com' },
    update: {},
    create: {
      name: 'Demo User',
      email: 'demo@yoolivery.com',
      password: '$2a$10$rQZ8kF5YhL9vM8N7B6cQCOQZ8kF5YhL9vM8N7B6cQCOQZ8kF5YhL9vM', // 'password123'
      phone: '+91 9876543210',
      address: 'Imphal West, Manipur 795001',
      dob: '1990-01-01',
      aadhaarLast4: '1234'
    }
  });

  console.log('âœ… Demo user created');

  console.log('ðŸŽ‰ Database seeded successfully!');
}

main()
  .catch((e) => {
    console.error('âŒ Error seeding database:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });